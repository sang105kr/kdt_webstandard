<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <textarea name="" id="comment" cols="30" rows="3"></textarea>
  <button class="addBtn">등록</button>
  <ul class="list"></ul>

  <template id="readMode">
    <li class="item"><span class="reply"></span> 
      <button class="modifyBtn">수정</button><button class="delBtn">삭제</button>
    </li>
  </template>
  <template id="modifyMode">
    <li class="item">
      <input type="text"><button class="saveBtn">저장</button><button class="cancelBtn">취소</button>
    </li>
  </template>  
  <script>
    //등록
    document.querySelector('.addBtn').addEventListener('click',evt=>{
      const $readeModeLi = readMode.content.cloneNode(true).querySelector('li');
      $readeModeLi.querySelector('.reply').textContent = comment.value;
      document.querySelector('.list').appendChild($readeModeLi);
    });

    document.querySelector('.list').addEventListener('click',evt=>{
      if(evt.target.tagName !== 'BUTTON') return;
      switch(evt.target.classList[0]){
        //수정
        case "modifyBtn" : modify(evt); break;
        //삭제  
        case "delBtn" : del(evt); break;
        //저장  
        case "saveBtn" : save(evt); break;
        //취소  
        case "cancelBtn" : cancel(evt); break;
      }      
    });

    function modify(e){
      console.log('수정');
      const $readModeLi = e.target.closest('li');
      const $modifyModeLi = modifyMode.content.cloneNode(true).querySelector('li');
      $modifyModeLi.querySelector('input').value = $readModeLi.querySelector('.reply').textContent;
      //댓글 초기값을 사용자정의 속성을 생성해 저장해둔다.
      $modifyModeLi.querySelector('input').dataset.oldText = $readModeLi.querySelector('.reply').textContent;
      $readModeLi.replaceWith($modifyModeLi);
    }
    function del(e){
      console.log('삭제');
      e.target.closest('li').remove();
    }
    function save(e){
      console.log('저장');
      const $readModeLi = readMode.content.cloneNode(true).querySelector('li');
      const $modifyModeLi = e.target.closest('li');
      $readModeLi.querySelector('.reply').textContent =  $modifyModeLi.querySelector('input').value;
      $modifyModeLi.replaceWith($readModeLi);
    }
    function cancel(e){
      console.log('취소');
      const $readModeLi = readMode.content.cloneNode(true).querySelector('li');
      const $modifyModeLi = e.target.closest('li');
      //댓글 초기값을 사용자정의 속성을 읽어온다.
      $readModeLi.querySelector('.reply').textContent =  $modifyModeLi.querySelector('input').dataset.oldText;
      $modifyModeLi.replaceWith($readModeLi);      
    }

  </script>
</body>
</html>